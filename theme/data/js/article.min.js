({init:function(){var t=this;t.time=1,t.initLeftMenu(t.bindLeftEvent),category&&t.bindRightMenu(),t.search(),t.bindScrollShow()},initLeftMenu:function(t){var e=this;$.getJSON("/category.json",function(a){$.each(a,function(t,a){for(var n=Date.parse(a.date),i="",l=a.tags.length-1;l>=0;l--)i+='<span class="node">'+a.tags[l]+"</span>";var s='<li class="menu-li"><span class="time">'+e.format(n)+'</span><div class="content"><a class="title" href="/'+a.link+'">'+a.title+'</a><div class="tags"><span>'+i+"</span></div></div></li>";$(".ul-div ul").append(s)}),t.call(e)})},bindLeftEvent:function(){var t=this,e=function(){var t=window.location.href;t=t.match(/index.html$/)?t:t+"index.html";for(var e=$(".menu-li"),a=0,n=0,i=0;i<e.length;i++)if(encodeURI(decodeURI(t)).indexOf(encodeURI(e.eq(i).find("a").attr("href")))>=0){a=e.eq(i).offset().top-document.body.scrollTop,n=i;break}return{getTop:function(){return a},getNum:function(){return n}}};$(".menu-li").eq(e().getNum()).addClass("active"),$("#toggle").click(function(a){a.preventDefault(),$(this).find(".top").toggleClass("active"),$(this).find(".middle").toggleClass("active"),$(this).find(".bottom").toggleClass("active"),$(".main-content").toggleClass("active"),$("#overlay").toggleClass("open"),$(".right-menu").toggleClass("active"),$(".ul-div").scrollTop(0),1==t.time&&($(".ul-div").animate({scrollTop:e().getTop()},500),t.time+=1)}),$(".main-content").click(function(){2==$(".main-content").attr("class").split(" ").length&&$("#toggle").trigger("click")});$(".ul-div").perfectScrollbar(),$(".menu-li").mouseenter(function(t){var e=$(t.delegateTarget);setTimeout(function(){e.is(":hover")&&e.find("div.tags").animate({"margin-top":"5px"},400)},500)}).mouseleave(function(t){$(t.delegateTarget).find("div.tags").animate({"margin-top":"-25px"},200)}),$(".title").on("click",function(){return history.pushState("","",$(this).attr("href")),$.ajax({url:$(this).attr("href"),success:function(e){$(".ul-div ul").empty(),$(".right-menu-ul").empty(),$(".main-content .row").html($(e).find(".row").html()),$(document).scrollTop(0),$("#toggle").off("click"),$(".main-content").off("click"),$(".tagnode").off("click"),$(".search").off("keyup"),t.time=1,$("#init").remove(),$("body").append($(e).filter("#init")),t.initLeftMenu(t.bindLeftEvent),category&&($(".right-menu").addClass("active"),console.log(123),t.bindRightMenu()),t.search()}}),!1})},bindRightMenu:function(){for(var t=$(".content").find("h2,h3"),e=t.length,a=0;e>a;){var n="tag"+a;t.eq(a).addClass(n),t.eq(a).attr("id",n);var i='<li ><a class="a'+a+'" href="#tag'+a+'">'+t.eq(a).html()+'</a>   <ul class="nav">';for(a+=1;e>a&&t.eq(a).is("h3");){var n="tag"+a;t.eq(a).addClass(n),t.eq(a).attr("id",n),i+='<li> <a class = "a'+a+' sub" href = "#tag'+a+'" > '+t.eq(a).html()+" </a> </li>",a++}i+="</ul></li>",$(".right-menu-ul").append(i)}$(".content").find("h2,h3,article").each(function(){new Waypoint({element:this,handler:function(t){var e=".a"+$(this.element).attr("class").charAt(3);$(".right-menu-ul a").removeClass("active"),$(".right-menu-ul ul").removeClass("active"),$(".right-menu-ul li ul li").removeClass("active"),$(e).hasClass("sub")&&($(e).parent().parent().addClass("active"),$(e).parent().parent().siblings("a").addClass("active")),$(e).addClass("active"),$(e).siblings("ul").addClass("active")},continuous:!1})});var l=parseInt($(".right-menu").offset().top);$(document).scroll(function(t){var e=document.body.scrollTop;e>=l?$(".right-menu").addClass("fixed"):($(".right-menu").removeClass("fixed"),$(".right-menu-ul a").removeClass("active"),$(".right-menu-ul ul").removeClass("active"),$(".right-menu-ul li ul li").removeClass("active"))})},search:function(){function t(t){e($.trim(n.val()))}function e(t){for(var e=$(".menu-li"),a=0;a<e.length;a++)e.eq(a).text().toLowerCase().indexOf(t.toLowerCase())<0?e.eq(a).hide():e.eq(a).show();$(".ul-div").animate({scrollTop:0},500)}function a(t){1==$(".main-content").attr("class").split(" ").length&&$("#toggle").trigger("click"),t.stopPropagation(),$(".search").val($(t.target).html()),e($(t.target).html())}var n=$(".search");n.bind("keyup",t),$(".tagnode").on("click",a)},bindScrollShow:function(){var t=!0,e=0,a=$(".search-div"),n=a.height();$(".ul-div").scroll(function(i){var l=parseInt($(".ps-scrollbar-y").css("top"));if(l!=e){if(n>l)return void a.fadeIn();t^e>l&&(t=!t,a.fadeToggle()),e=l}})},format:function(t){var e=parseInt((Date.now()-t)/1e3);return 60>e?parseInt(e/60)+" secs ago":60>e/60?parseInt(e/60)+" mins ago":24>e/3600?parseInt(e/3600)+" hrs ago":30>e/86400?parseInt(e/86400)+" days ago":t.toString("MMM d yyyy")}}).init();